import{g as F,p as M,u as z,r as u,o as J,I as K,w as A,n as q,a as _,m as E,c as a,f as G,d as U,b as Q,e as j,h as W,i as C,j as S,F as x,k,l as i,q as b,s as X,t as H,v as O,x as Y,y as Z,z as ee,A as te,B as ae,C as ne,D as le,E as oe,G as se}from"./index-DhG7WtGS.js";import{u as ue,V as B,m as re,a as ie,b as ce,c as de,d as me,e as fe}from"./VMenu-D629rLpU.js";import{f as ve,V as pe}from"./VTextField-Tzad9CkG.js";import{V as ge,a as w,u as Ve,m as ke,b as he,c as be}from"./VGrid-BHrNSwev.js";import{c as ye,V as T,a as L,b as D,d as Se,e as I}from"./VDivider-B7X9T9Y_.js";import{V as we}from"./VSnackbar-DEXP5dPX.js";const Pe=M({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...re({origin:"center center",scrollStrategy:"block",transition:{component:ie},zIndex:2400})},"VDialog"),N=F()({name:"VDialog",props:Pe(),emits:{"update:modelValue":n=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(n,r){let{emit:m,slots:p}=r;const c=z(n,"modelValue"),{scopeId:V}=ue(),s=u();function f(d){var l,v;const t=d.relatedTarget,e=d.target;if(t!==e&&((l=s.value)!=null&&l.contentEl)&&((v=s.value)!=null&&v.globalTop)&&![document,s.value.contentEl].includes(e)&&!s.value.contentEl.contains(e)){const o=G(s.value.contentEl);if(!o.length)return;const g=o[0],P=o[o.length-1];t===g?P.focus():g.focus()}}J(()=>{document.removeEventListener("focusin",f)}),K&&A(()=>c.value&&n.retainFocus,d=>{d?document.addEventListener("focusin",f):document.removeEventListener("focusin",f)},{immediate:!0});function y(){var d;m("afterEnter"),(d=s.value)!=null&&d.contentEl&&!s.value.contentEl.contains(document.activeElement)&&s.value.contentEl.focus({preventScroll:!0})}function h(){m("afterLeave")}return A(c,async d=>{var t;d||(await q(),(t=s.value.activatorEl)==null||t.focus({preventScroll:!0}))}),_(()=>{const d=B.filterProps(n),t=E({"aria-haspopup":"dialog"},n.activatorProps),e=E({tabindex:-1},n.contentProps);return a(B,E({ref:s,class:["v-dialog",{"v-dialog--fullscreen":n.fullscreen,"v-dialog--scrollable":n.scrollable},n.class],style:n.style},d,{modelValue:c.value,"onUpdate:modelValue":l=>c.value=l,"aria-modal":"true",activatorProps:t,contentProps:e,height:n.fullscreen?void 0:n.height,width:n.fullscreen?void 0:n.width,maxHeight:n.fullscreen?void 0:n.maxHeight,maxWidth:n.fullscreen?void 0:n.maxWidth,role:"dialog",onAfterEnter:y,onAfterLeave:h},V),{activator:p.activator,default:function(){for(var l=arguments.length,v=new Array(l),o=0;o<l;o++)v[o]=arguments[o];return a(ge,{root:"VDialog"},{default:()=>{var g;return[(g=p.default)==null?void 0:g.call(p,...v)]}})}})}),ve({},s)}}),R=ye("v-spacer","div","VSpacer"),Ee=U({__name:"SettingsButton",setup(n){const r=u(""),m=Q("anum"),p=u(""),c=async()=>{const t=await fetch("https://api.tesc.farm/logout",{credentials:"include"});t.ok?router.push("/login"):(flash.value=t.statusText,snackbar.value=!0)},V=async()=>{const t=await fetch("https://api.tesc.farm/hours/punchoutall",{credentials:"include"});t.ok||(flash.value=t.statusText,snackbar.value=!0),updateWorking(),confirmPunchOut.value=!1,selected.value=0},s=()=>{r.value!=""&&(selected.value==-1?clockOff(r.value):clockOn(r.value,selected.value),r.value="")},f=t=>{r.value.length>8&&(s(),t.target.focus())},y=async()=>{const t={barcode:r.value},e=await fetch("https://api.tesc.farm/worker/lookup",{method:"POST",credentials:"include",body:JSON.stringify(t)});e.ok||console.log(e);const l=await e.json();p.value=l.barcode},h=u([{title:"Edit A#",action:()=>{editanum.value=!0},users:["worker","admin"]},{title:"Stop Tracking All",action:()=>{confirmPunchOut.value=!0},users:["admin"]},{title:"Logout",action:c,users:["worker","admin"]}]),d=j(()=>{const t=route.meta.userstatus;return h.value.filter(e=>e.users.includes(t))});return W(()=>{r.value=localStorage.getItem("anumber"),r.value?(f(),y()):editanum.value=!0}),(t,e)=>(S(),C(x,null,[a(N,{modelValue:t.editanum,"onUpdate:modelValue":e[2]||(e[2]=l=>t.editanum=l),persistent:!k(r)},{default:i(()=>[a(T,{class:"ma-auto w-100","max-width":"400","prepend-icon":"mdi-settings"},{default:i(()=>[a(L,null,{default:i(()=>e[5]||(e[5]=[b("Edit A#")])),_:1}),a(D,null,{default:i(()=>e[6]||(e[6]=[b("Set your A# to track tasks")])),_:1}),a(Se,null,{default:i(()=>[a(pe,{id:"anum",ref_key:"anum",ref:m,"prepend-icon":t.result,modelValue:k(r),"onUpdate:modelValue":e[0]||(e[0]=l=>H(r)?r.value=l:null),onInput:f,onKeyup:X(s,["enter"]),hint:"Enter the A# from your student ID",label:"A#"},null,8,["prepend-icon","modelValue"])]),_:1}),a(I,null,{default:i(()=>[k(r)?(S(),O(w,{key:0,class:"ms-auto",text:"Close",onClick:e[1]||(e[1]=l=>t.editanum=!1)})):Y("",!0),a(R),a(w,{class:"ms-auto",text:"Save",onClick:s})]),_:1})]),_:1})]),_:1},8,["modelValue","persistent"]),a(N,{modelValue:t.confirmPunchOut,"onUpdate:modelValue":e[4]||(e[4]=l=>t.confirmPunchOut=l)},{default:i(()=>[a(T,{class:"ma-auto w-100","max-width":"400","prepend-icon":"mdi-settings"},{default:i(()=>[a(L,null,{default:i(()=>e[7]||(e[7]=[b("Punch Out All Active Workers?")])),_:1}),a(D,null,{default:i(()=>e[8]||(e[8]=[b("Are you Sure?")])),_:1}),a(I,null,{default:i(()=>[a(w,{class:"ms-auto",text:"Cancel",onClick:e[3]||(e[3]=l=>t.confirmPunchOut=!1)}),a(R),a(w,{class:"ms-auto",text:"Confirm",onClick:V})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(ce,null,{default:i(()=>[a(de,null,{default:i(()=>[(S(!0),C(x,null,Z(k(d),l=>(S(),O(me,{title:l.title,onClick:l.action},null,8,["title","onClick"]))),256))]),_:1})]),_:1})],64))}}),Ce=M({scrollable:Boolean,...te(),...he(),...ke({tag:"main"})},"VMain"),xe=F()({name:"VMain",props:Ce(),setup(n,r){let{slots:m}=r;const{dimensionStyles:p}=Ve(n),{mainStyles:c}=ee(),{ssrBootStyles:V}=fe();return _(()=>a(n.tag,{class:["v-main",{"v-main--scrollable":n.scrollable},n.class],style:[c.value,V.value,p.value,n.style]},{default:()=>{var s,f;return[n.scrollable?a("div",{class:"v-main__scroller"},[(s=m.default)==null?void 0:s.call(m)]):(f=m.default)==null?void 0:f.call(m)]}})),{}}}),Ie=U({__name:"default",setup(n){const r=ae(),m=u(!1),p=u(!1);u(!1),u(!1),u([]),u([]),u("");const c=u(""),V=u("");u(0);const s=u("mdi-form-textbox"),f=u(!1),y=u("error"),h=u("");u({});const d=async()=>{const v=await fetch("https://api.tesc.farm/logout",{credentials:"include"});v.ok?se.push("/login"):(h.value=v.statusText,f.value=!0)},t=async()=>{const v={barcode:c.value},o=await fetch("https://api.tesc.farm/worker/lookup",{method:"POST",credentials:"include",body:JSON.stringify(v)});o.ok||console.log(o);const g=await o.json();V.value=g.barcode},e=()=>{c.value.length==9&&c.value[0]=="A"&&!isNaN(Number(c.value.substring(1)))?s.value="mdi-check-circle":s.value="mdi-form-textbox"};j(()=>{const v=r.meta.userstatus;return l.value.filter(o=>o.users.includes(v))});const l=u([{title:"Edit A#",action:()=>{m.value=!0},users:["worker","admin"]},{title:"Stop Tracking All",action:()=>{p.value=!0},users:["admin"]},{title:"Logout",action:d,users:["worker","admin"]}]);return W(()=>{c.value=localStorage.getItem("anumber"),c.value?(e(),t()):m.value=!0}),(v,o)=>{const g=Ee,P=ne("RouterView");return S(),C(x,null,[o[2]||(o[2]=le("a",{href:"#main-content",class:"screen-reader-text skip-to-main-content-link"},"Skip to main content",-1)),a(xe,null,{default:i(()=>[a(g,null,{default:i(()=>[a(w,{variant:"tonal"},{default:i(()=>[a(be,null,{default:i(()=>o[1]||(o[1]=[b("mdi-cog")])),_:1})]),_:1})]),_:1}),a(P),a(we,{modelValue:k(f),"onUpdate:modelValue":o[0]||(o[0]=$=>H(f)?f.value=$:null),timeout:"2000",location:"top",color:k(y)},{default:i(()=>[b(oe(k(h)),1)]),_:1},8,["modelValue","color"])]),_:1})],64)}}});export{Ie as default};
