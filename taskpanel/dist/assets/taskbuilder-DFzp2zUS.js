import{d as E,r as o,h as F,o as H,i as k,D as a,c as s,l as n,F as C,j as r,y as g,k as u,v as D,U as I,H as b,q as i,E as p}from"./index-B1rTmADD.js";import{h as x,V as T,d as V,a as w,f as O}from"./VDivider-reVCDhED.js";import{V as y,a as h}from"./VRow-zDqRUmta.js";import{a as P}from"./VGrid-B2QB3Mq-.js";const q=["onClick"],J=["href","onClick"],L=["href","onClick"],X=E({__name:"taskbuilder",setup(R){o(0);const j=o([{ID:1,name:"Preharvest",action:"preharvest",users:["worker","admin"]},{ID:2,name:"Harvest",action:"harvest",users:["worker","admin"]}]),f=o({}),_=o({}),c=o(0),m=o(0),v=o(0),B=o(!1),M=o(""),S=async()=>{B.value=!0;try{const l=await fetch("https://api.tesc.farm/tasks");l.ok||console.log(l.status),f.value=await l.json(),f.value=f.value.filter(e=>e.tags.some(t=>t.name=="Management Unit"))}catch(l){console.log(l)}},U=async()=>{B.value=!0;try{const l=await fetch("https://api.tesc.farm/crops");l.ok||console.log(l.status),_.value=await l.json()}catch(l){console.log(l)}},$=l=>{c.value!=l&&(c.value=l)},A=l=>{m.value!=l&&(m.value=l)},N=l=>{v.value!=l&&(v.value=l)},z=async()=>{const l={area_id:c.value,crop_id:m.value,type_id:v.value},e=await fetch("https://api.tesc.farm/task/new",{method:"POST",credentials:"include",body:JSON.stringify(l)});e.ok||(M.value=e.statusText,snackbar.value=!0,console.log(e))};return F(()=>{S(),U()}),H(()=>{clearInterval(intervalID)}),(l,e)=>(r(),k(C,null,[e[1]||(e[1]=a("h1",null,"Task Builder",-1)),e[2]||(e[2]=a("br",null,null,-1)),s(x),e[3]||(e[3]=a("br",null,null,-1)),e[4]||(e[4]=a("h2",null,"Choose Area",-1)),s(y,null,{default:n(()=>[(r(!0),k(C,null,g(u(f),t=>(r(),D(h,{key:t.ID,class:"d-flex flex-column",cols:"12",sm:"4",md:"3",lg:"2"},{default:n(()=>[a("a",{class:"card-button",href:"#",onClick:I(d=>$(t.ID),["prevent"])},[s(T,{class:b(["task-card d-flex flex-column text-center",{selected:u(c)==t.ID}]),variant:"tonal",onClick:d=>$(t.ID)},{default:n(()=>[s(V,null,{default:n(()=>[s(w,null,{default:n(()=>[i(p(t.name),1)]),_:2},1024)]),_:2},1024),s(O,null,{default:n(()=>[i(p(t.description),1)]),_:2},1024)]),_:2},1032,["class","onClick"])],8,q)]),_:2},1024))),128))]),_:1}),e[5]||(e[5]=a("br",null,null,-1)),s(x),e[6]||(e[6]=a("br",null,null,-1)),e[7]||(e[7]=a("h2",null,"Choose Crop",-1)),s(y,null,{default:n(()=>[(r(!0),k(C,null,g(u(_),t=>(r(),D(h,{key:t.ID,class:"d-flex flex-column",cols:"12",sm:"4",md:"3",lg:"2"},{default:n(()=>[a("a",{class:"card-button",href:"/punch/"+t.ID,onClick:I(d=>A(t.ID),["prevent"])},[s(T,{class:b(["task-card d-flex flex-column text-center",{selected:u(m)==t.ID}]),variant:"tonal",onClick:d=>A(t.ID)},{default:n(()=>[s(V,null,{default:n(()=>[s(w,null,{default:n(()=>[i(p(t.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"])],8,J)]),_:2},1024))),128))]),_:1}),e[8]||(e[8]=a("br",null,null,-1)),s(x),e[9]||(e[9]=a("br",null,null,-1)),e[10]||(e[10]=a("h2",null,"Task Type",-1)),s(y,null,{default:n(()=>[(r(!0),k(C,null,g(u(j),t=>(r(),D(h,{key:t.ID,class:"d-flex flex-column",cols:"12",sm:"4",md:"3",lg:"2"},{default:n(()=>[a("a",{class:"card-button",href:"/punch/"+t.ID,onClick:I(d=>N(t.ID),["prevent"])},[s(T,{class:b(["task-card d-flex flex-column text-center",{selected:u(v)==t.ID}]),variant:"tonal",onClick:d=>N(t.ID)},{default:n(()=>[s(V,null,{default:n(()=>[s(w,null,{default:n(()=>[i(p(t.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"])],8,L)]),_:2},1024))),128))]),_:1}),e[11]||(e[11]=a("br",null,null,-1)),s(x),e[12]||(e[12]=a("br",null,null,-1)),s(P,{size:"x-large",variant:"tonal",onClick:z},{default:n(()=>e[0]||(e[0]=[i(" Create Task ")])),_:1})],64))}});export{X as default};
