import{d as F,f as n,j as O,k as P,b as k,e as o,c as s,w as a,F as v,o as r,s as C,q as c,t as h,M as x,v as _,x as d,z as p}from"./index-Otowk1Gi.js";import{V as I,a as D,b as g,f as T,d as w,h as q}from"./VRow-Dd4OLhoh.js";import{V as E}from"./VBtn-BjHShccG.js";import"./tag-CG2zx-Ob.js";const H=["href","onClick"],J=["href","onClick"],L=["href","onClick"],W=F({__name:"taskbuilder",setup(R){n(0);const N=n([{ID:1,name:"Preharvest",action:"preharvest",users:["worker","admin"]},{ID:2,name:"Harvest",action:"harvest",users:["worker","admin"]}]),V=n({}),y=n({}),i=n(0),f=n(0),m=n(0),b=n(!1),j=n(""),z=async()=>{b.value=!0;try{const e=await fetch("https://api.tesc.farm/areas");e.ok||console.log(e.status),V.value=await e.json()}catch(e){console.log(e)}},M=async()=>{b.value=!0;try{const e=await fetch("https://api.tesc.farm/crops");e.ok||console.log(e.status),y.value=await e.json()}catch(e){console.log(e)}},B=e=>{i.value!=e&&(i.value=e)},$=e=>{f.value!=e&&(f.value=e)},A=e=>{m.value!=e&&(m.value=e)},S=async()=>{const e={area_id:i.value,crop_id:f.value,type:m.value},l=await fetch("https://api.tesc.farm/task/new",{method:"POST",credentials:"include",body:JSON.stringify(e)});l.ok||(j.value=l.statusText,snackbar.value=!0,console.log(l))};return O(()=>{z(),M()}),P(()=>{clearInterval(intervalID)}),(e,l)=>(r(),k(v,null,[l[1]||(l[1]=o("h1",null,"Task Builder",-1)),l[2]||(l[2]=o("h2",null,"Choose Area",-1)),s(I,null,{default:a(()=>[(r(!0),k(v,null,C(c(V),t=>(r(),h(D,{key:t.ID,class:"d-flex flex-column",cols:"12",sm:"4",md:"3",lg:"2"},{default:a(()=>[o("a",{class:"card-button",href:"/punch/"+e.task.ID,onClick:x(u=>B(t.ID),["prevent"])},[s(g,{class:_(["task-card d-flex flex-column text-center",{selected:c(i)==t.ID}]),variant:"tonal",onClick:u=>B(t.ID)},{default:a(()=>[s(T,null,{default:a(()=>[s(w,null,{default:a(()=>[d(p(t.name),1)]),_:2},1024)]),_:2},1024),s(q,null,{default:a(()=>[d(p(t.description),1)]),_:2},1024)]),_:2},1032,["class","onClick"])],8,H)]),_:2},1024))),128))]),_:1}),l[3]||(l[3]=o("h2",null,"Choose Crop",-1)),s(I,null,{default:a(()=>[(r(!0),k(v,null,C(c(y),t=>(r(),h(D,{key:t.ID,class:"d-flex flex-column",cols:"12",sm:"4",md:"3",lg:"2"},{default:a(()=>[o("a",{class:"card-button",href:"/punch/"+t.ID,onClick:x(u=>$(t.ID),["prevent"])},[s(g,{class:_(["task-card d-flex flex-column text-center",{selected:c(f)==t.ID}]),variant:"tonal",onClick:u=>$(t.ID)},{default:a(()=>[s(T,null,{default:a(()=>[s(w,null,{default:a(()=>[d(p(t.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"])],8,J)]),_:2},1024))),128))]),_:1}),l[4]||(l[4]=o("h2",null,"Task Type",-1)),s(I,null,{default:a(()=>[(r(!0),k(v,null,C(c(N),t=>(r(),h(D,{key:t.ID,class:"d-flex flex-column",cols:"12",sm:"4",md:"3",lg:"2"},{default:a(()=>[o("a",{class:"card-button",href:"/punch/"+t.ID,onClick:x(u=>A(t.ID),["prevent"])},[s(g,{class:_(["task-card d-flex flex-column text-center",{selected:c(m)==t.ID}]),variant:"tonal",onClick:u=>A(t.ID)},{default:a(()=>[s(T,null,{default:a(()=>[s(w,null,{default:a(()=>[d(p(t.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"])],8,L)]),_:2},1024))),128))]),_:1}),s(E,{size:"x-large",variant:"tonal",onClick:S},{default:a(()=>l[0]||(l[0]=[d(" Create Task ")])),_:1})],64))}});export{W as default};
