import{f as b,V as $,a as z,_ as O}from"./VSwitch-B0UQB2hB.js";import{d as q,r as n,e as G,h as x,i as H,o as L,j as h,k as g,c as s,y as M,s as r,q as m,l,F as D,z as W,x as J,H as P,t as S,v as U,G as Q,n as X}from"./index-CHZdWgAM.js";import{f as _,g as k}from"./VDivider-DLQHfrc3.js";import{V as j,a as Y}from"./VTextField-BpdqMzPS.js";import{a as Z}from"./VGrid-BlS_v7Lu.js";import{V as ee}from"./VSnackbar-DeFgVnS-.js";import"./VMenu-qtkikoXf.js";const ae={key:0,id:"anumfloat",class:"align-self-end"},ce=q({__name:"index",setup(le){const V=n(!1),f=n(!1),c=n([]),d=n(""),p=n(""),u=n(0),A=n("mdi-form-textbox"),y=n(!1),B=n("success"),E=n(""),i=n({}),v=n({}),C=G("anum"),N=x(()=>{const a=new Set;for(const e of Array.from(i.value))for(const o of e.tags)a.add(o.name);return Array.from(a)}),F=x(()=>{let a=Array.from(i.value);return f.value?a.sort((e,o)=>e.name.localeCompare(o.name)):(a=a.filter(e=>b.includes(e.ID)),a.sort((e,o)=>b.indexOf(e.ID)-b.indexOf(o.ID))),c.value.length>0&&(a=a.filter(e=>e.tags.some(o=>c.value.includes(o.name)))),d.value&&(a=a.filter(e=>(e.name+e.description).toUpperCase().includes(d.value.toUpperCase()))),a}),K=x(()=>u.value==0?"None":u.value<0?"Stop Tracking Time":i.value.find(a=>a.ID===u.value).name),w=a=>{u.value=a,a!=0&&X(()=>{var e;(e=C.value)==null||e.focus()})},R=async()=>{V.value=!0;try{const a=await fetch("https://api.tesc.farm/tasks");a.ok||console.log(a.status),i.value=await a.json(),i.value.forEach(e=>{v.value[e.ID]=0})}catch(a){console.log(a)}finally{I()}},I=async()=>{V.value=!0;try{const a=await fetch("https://api.tesc.farm/hours/working");a.ok||console.log(a.status),i.value.forEach(o=>{v.value[o.ID]=0}),(await a.json()).forEach(o=>{v.value[o.task_id]++})}catch(a){console.log(a)}finally{V.value=!1}};let T;return H(()=>{R(),T=setInterval(I,6e4)}),L(()=>{clearInterval(T)}),(a,e)=>{const o=O;return g(),h(D,null,[s(Y,{fluid:"",id:"taskpanel",class:"fill-height d-flex flex-column withfloat"},{default:r(()=>[s(_,{id:"filters",class:"align-self-start d-flex w-100"},{default:r(()=>[s(k,{cols:"12",sm:"4",md:"8"},{default:r(()=>[s(j,{id:"search",modelValue:l(d),"onUpdate:modelValue":e[0]||(e[0]=t=>m(d)?d.value=t:null),clearable:"",label:"Search",hint:"Search for tasks by name or description"},null,8,["modelValue"])]),_:1}),s(k,{cols:"6",sm:"4",md:"2"},{default:r(()=>[s($,{clearable:"",chips:"",multiple:"",label:"Tags",modelValue:l(c),"onUpdate:modelValue":e[1]||(e[1]=t=>m(c)?c.value=t:null),items:l(N)},null,8,["modelValue","items"])]),_:1}),s(k,{cols:"6",sm:"4",md:"2",class:"d-flex align-self-start"},{default:r(()=>[s(z,{label:"Show All",inset:"",color:"secondary",modelValue:l(f),"onUpdate:modelValue":e[2]||(e[2]=t=>m(f)?f.value=t:null)},null,8,["modelValue"])]),_:1})]),_:1}),s(_,{id:"main-content",align:"center",justify:"center",class:"d-flex flex-row w-100"},{default:r(()=>[(g(!0),h(D,null,W(l(F),t=>(g(),J(o,{task:t,anumber:l(p),working:l(v)[t.ID],selected:l(u)==t.ID,onSelect:w},null,8,["task","anumber","working","selected"]))),256)),s(k,{cols:"12"},{default:r(()=>[s(Z,{class:P(["bigbutton",{selected:l(u)==-1}]),variant:"tonal",onClick:e[3]||(e[3]=t=>w(-1))},{default:r(()=>e[7]||(e[7]=[S(" Stop Tracking Time ")])),_:1},8,["class"])]),_:1})]),_:1})]),_:1}),l(u)?(g(),h("div",ae,[s(j,{id:"anum",ref_key:"anum",ref:C,"prepend-icon":l(A),modelValue:l(p),"onUpdate:modelValue":e[4]||(e[4]=t=>m(p)?p.value=t:null),onInput:a.anumCheck,onKeyup:U(a.submitAnum,["enter"]),onKeydown:e[5]||(e[5]=U(t=>w(0),["esc"])),hint:"Enter the A# from your student ID",label:l(K),autocomplete:"off"},null,8,["prepend-icon","modelValue","onInput","onKeyup","label"])])):M("",!0),s(ee,{modelValue:l(y),"onUpdate:modelValue":e[6]||(e[6]=t=>m(y)?y.value=t:null),timeout:"2000",location:"top",color:l(B)},{default:r(()=>[S(Q(l(E)),1)]),_:1},8,["modelValue","color"])],64)}}});export{ce as default};
