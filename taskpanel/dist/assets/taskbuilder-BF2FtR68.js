import{d as H,r as o,j as J,o as O,k,G as a,c as s,t as n,F as C,l as r,A as g,q as u,y as D,X as I,J as b,v as i,H as p}from"./index-Dr_Z-5RT.js";import{j as x,f as T,g as V,V as w,d as y,a as _,h as P}from"./VDivider-odZKMi8a.js";import{a as U}from"./VGrid-i-kZP7zF.js";const q=["onClick"],E=["href","onClick"],G=["href","onClick"],Q=H({__name:"taskbuilder",setup(L){o(0);const N=o([{ID:1,name:"Preharvest",action:"preharvest",users:["worker","admin"]},{ID:2,name:"Harvest",action:"harvest",users:["worker","admin"]}]),f=o({}),h=o({}),c=o(0),m=o(0),v=o(0),B=o(!1),M=o(""),S=async()=>{B.value=!0;try{const l=await fetch("https://api.tesc.farm/tasks");l.ok||console.log(l.status),f.value=await l.json(),f.value=f.value.filter(e=>e.tags.some(t=>t.name=="Management Unit"))}catch(l){console.log(l)}},z=async()=>{B.value=!0;try{const l=await fetch("https://api.tesc.farm/crops");l.ok||console.log(l.status),h.value=await l.json()}catch(l){console.log(l)}},$=l=>{c.value!=l&&(c.value=l)},A=l=>{m.value!=l&&(m.value=l)},j=l=>{v.value!=l&&(v.value=l)},F=async()=>{const l={area_id:c.value,crop_id:m.value,type_id:v.value},e=await fetch("https://api.tesc.farm/task/new",{method:"POST",credentials:"include",body:JSON.stringify(l)});e.ok||(M.value=e.statusText,snackbar.value=!0,console.log(e))};return J(()=>{S(),z()}),O(()=>{clearInterval(intervalID)}),(l,e)=>(r(),k(C,null,[e[1]||(e[1]=a("h1",null,"Task Builder",-1)),e[2]||(e[2]=a("br",null,null,-1)),s(x),e[3]||(e[3]=a("br",null,null,-1)),e[4]||(e[4]=a("h2",null,"Choose Area",-1)),s(T,null,{default:n(()=>[(r(!0),k(C,null,g(u(f),t=>(r(),D(V,{key:t.ID,class:"d-flex flex-column",cols:"12",sm:"4",md:"3",lg:"2"},{default:n(()=>[a("a",{class:"card-button",href:"#",onClick:I(d=>$(t.ID),["prevent"])},[s(w,{class:b(["task-card d-flex flex-column text-center",{selected:u(c)==t.ID}]),variant:"tonal",onClick:d=>$(t.ID)},{default:n(()=>[s(y,null,{default:n(()=>[s(_,null,{default:n(()=>[i(p(t.name),1)]),_:2},1024)]),_:2},1024),s(P,null,{default:n(()=>[i(p(t.description),1)]),_:2},1024)]),_:2},1032,["class","onClick"])],8,q)]),_:2},1024))),128))]),_:1}),e[5]||(e[5]=a("br",null,null,-1)),s(x),e[6]||(e[6]=a("br",null,null,-1)),e[7]||(e[7]=a("h2",null,"Choose Crop",-1)),s(T,null,{default:n(()=>[(r(!0),k(C,null,g(u(h),t=>(r(),D(V,{key:t.ID,class:"d-flex flex-column",cols:"12",sm:"4",md:"3",lg:"2"},{default:n(()=>[a("a",{class:"card-button",href:"/punch/"+t.ID,onClick:I(d=>A(t.ID),["prevent"])},[s(w,{class:b(["task-card d-flex flex-column text-center",{selected:u(m)==t.ID}]),variant:"tonal",onClick:d=>A(t.ID)},{default:n(()=>[s(y,null,{default:n(()=>[s(_,null,{default:n(()=>[i(p(t.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"])],8,E)]),_:2},1024))),128))]),_:1}),e[8]||(e[8]=a("br",null,null,-1)),s(x),e[9]||(e[9]=a("br",null,null,-1)),e[10]||(e[10]=a("h2",null,"Task Type",-1)),s(T,null,{default:n(()=>[(r(!0),k(C,null,g(u(N),t=>(r(),D(V,{key:t.ID,class:"d-flex flex-column",cols:"12",sm:"4",md:"3",lg:"2"},{default:n(()=>[a("a",{class:"card-button",href:"/punch/"+t.ID,onClick:I(d=>j(t.ID),["prevent"])},[s(w,{class:b(["task-card d-flex flex-column text-center",{selected:u(v)==t.ID}]),variant:"tonal",onClick:d=>j(t.ID)},{default:n(()=>[s(y,null,{default:n(()=>[s(_,null,{default:n(()=>[i(p(t.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class","onClick"])],8,G)]),_:2},1024))),128))]),_:1}),e[11]||(e[11]=a("br",null,null,-1)),s(x),e[12]||(e[12]=a("br",null,null,-1)),s(U,{size:"x-large",variant:"tonal",onClick:F},{default:n(()=>e[0]||(e[0]=[i(" Create Task ")])),_:1})],64))}});export{Q as default};
