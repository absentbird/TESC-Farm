import{_ as B}from"./CardSelector.vue_vue_type_script_setup_true_lang-BeyLbHOb.js";import{b as D,d as u}from"./VTextField-FcwR6-Fq.js";import{d as A,S,b as x,r,i as d,T as C,j as E,o as N,k as T,l as V,P as R,c as _,R as j,q as s,t as F,v as M,F as $}from"./index-daL3Nt90.js";import"./VMenu-9Go3kMgs.js";import"./VContainer-PrXbU0_v.js";const q={class:"pl-8"},J=A({__name:"[id]",setup(H){const w=S(),c=x(),n=r(!1),o=r(0),f=r(""),i=r(""),l=r(Array()),v=r(c.params.id),p=d(()=>l.value.filter(a=>a.area_id==c.params.id)),g=d(()=>c.meta.userstatus=="admin"),b=d(()=>{const a=p.value.find(t=>t.area);return a?a.area.name:"Area #"+String(v.value)}),m=async()=>{n.value=!0,o.value=0;const a=Array.from(await u("/hours/working")),t={};l.value.forEach(e=>{t[e.ID]=0}),a.forEach(e=>{t[e.task_id]++,e.worker.barcode==f.value&&(o.value=e.task_id)}),l.value.forEach(e=>{e.working=t[e.ID],e.selected=e.ID==o.value}),n.value=!1},h=async()=>{n.value=!0,l.value=Array.from(await u("/tasks")),m(),n.value=!1},y=async()=>{const a=await u("/worker/lookup",{barcode:i.value});f.value=a.barcode},I=async a=>{o.value!=a&&(await u("/hours/punch",{anum:i,task:a}),m())};C(()=>{y(),h()});let k;return E(()=>{i.value=localStorage.getItem("anumber"),k=setInterval(m,6e4)}),N(()=>{clearInterval(k)}),(a,t)=>{const e=B;return V(),T($,null,[R("h2",q,j(s(b)),1),_(D,{onClick:t[0]||(t[0]=L=>s(w).push("/area")),variant:"tonal",class:"ml-7"},{default:F(()=>t[1]||(t[1]=[M("Back to Areas")])),_:1}),_(e,{tracking:"",items:s(p),onSelect:I,newItem:s(g)?"/taskbuilder?area="+s(v):"",selected:s(o)},null,8,["items","newItem","selected"])],64)}}});export{J as default};
