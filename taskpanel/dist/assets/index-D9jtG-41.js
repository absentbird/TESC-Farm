import{_ as g}from"./CardSelector.vue_vue_type_script_setup_true_lang-CmivaplB.js";import{d as s}from"./VTextField-Bzyb5WDc.js";import{d as h,S as I,b,r as t,i as y,T as A,j as S,o as x,y as B,l as C,t as D,c as E,q as d}from"./index-DsmxeAVp.js";import{l as R}from"./VMenu-BdpgoByb.js";import"./VContainer-BAseW2YN.js";const L=h({__name:"index",setup(j){const f=I(),p=b(),l=t(!1),n=t(0),i=t(""),c=t(""),o=t(Array()),v=y(()=>p.meta.userstatus=="admin"),u=async()=>{l.value=!0;const a=Array.from(await s("/hours/working")),r={};o.value.forEach(e=>{r[e.ID]=0}),a.forEach(e=>{r[e.task.area_id]++,e.worker.barcode==i.value&&(n.value=e.task.area_id)}),o.value.forEach(e=>{e.working=r[e.ID],e.selected=e.ID==n.value}),l.value=!1},_=async()=>{o.value=await s("/areas"),u()},k=async()=>{const a=await s("/worker/lookup",{barcode:c.value});i.value=a.barcode},w=async a=>{if(a==0){n.value=0,await s("/hours/punch",{anum:c.value}),u();return}f.push("/area/"+String(a))};A(()=>{k(),_()});let m;return S(()=>{c.value=localStorage.getItem("anumber"),m=setInterval(u,6e4)}),x(()=>{clearInterval(m)}),(a,r)=>{const e=g;return C(),B(R,null,{default:D(()=>[E(e,{tracking:"",items:d(o),newItem:d(v)?"/area/builder":"",onSelect:w},null,8,["items","newItem"])]),_:1})}}});export{L as default};
