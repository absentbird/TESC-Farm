import{_ as y}from"./CardSelector.vue_vue_type_script_setup_true_lang--AXxwtOZ.js";import{a as l}from"./apicall-Bi9Wkbxh.js";import{d as B,T as D,b as A,r,i as v,U as x,j as C,o as E,k as T,l as S,c as p,t as V,v as j,q as u,F}from"./index-CPnaz9z_.js";import{b as M}from"./VTextField-CE9Adw70.js";import"./VSwitch-Cia7arMN.js";import"./VMenu-D-kSU3oW.js";import"./VContainer-DlUOaJ08.js";const G=B({__name:"[id]",setup(N){const k=D(),c=A(),o=r(!1),s=r(0),d=r(""),i=r(""),n=r(Array()),w=r(c.params.id),_=v(()=>n.value.filter(e=>e.area_id==c.params.id)),g=v(()=>c.meta.userstatus=="admin"),m=async()=>{o.value=!0,s.value=0;const e=Array.from(await l("/hours/working")),t={};n.value.forEach(a=>{t[a.ID]=0}),e.forEach(a=>{t[a.task_id]++,a.worker.barcode==d.value&&(s.value=a.task_id)}),n.value.forEach(a=>{a.working=t[a.ID],a.selected=a.ID==s.value}),o.value=!1},b=async()=>{o.value=!0,n.value=Array.from(await l("/tasks")),m(),o.value=!1},I=async()=>{const e=await l("/worker/lookup",{barcode:i.value});d.value=e.barcode},h=async e=>{s.value!=e&&(await l("/hours/punch",{anum:i,task:e}),m())};x(()=>{I(),b()});let f;return C(()=>{i.value=localStorage.getItem("anumber"),f=setInterval(m,6e4)}),E(()=>{clearInterval(f)}),(e,t)=>{const a=y;return S(),T(F,null,[p(M,{onClick:t[0]||(t[0]=R=>u(k).push("/area")),variant:"tonal",class:"ml-7"},{default:V(()=>t[1]||(t[1]=[j("Back to Areas")])),_:1}),p(a,{search:"",tracking:"",items:u(_),onSelect:h,newItem:u(g)?"/taskbuilder?area="+u(w):""},null,8,["items","newItem"])],64)}}});export{G as default};
