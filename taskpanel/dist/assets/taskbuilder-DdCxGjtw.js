import{_ as R}from"./CardSelector.vue_vue_type_script_setup_true_lang-CmivaplB.js";import{b as g,d as v}from"./VTextField-Bzyb5WDc.js";import{d as j,S as z,b as E,r as o,i as y,j as M,k as P,l as F,P as l,c as a,t as m,v as I,q as d}from"./index-DsmxeAVp.js";import{o as f,l as C}from"./VMenu-BdpgoByb.js";import"./VContainer-BAseW2YN.js";const G={id:"main-content",class:"pa-8 pt-0"},W=j({__name:"taskbuilder",setup(H){const k=z(),T=E(),c=o([]),p=o([]),b=o([]),n=o(0),s=o(0),u=o(0);T.query.area&&(n.value=Number(T.query.area));const B=y(()=>c.value.map(t=>(t.selected=t.ID==n.value,t))),D=y(()=>p.value.map(t=>(t.selected=t.ID==s.value,t))),V=y(()=>b.value.map(t=>(t.selected=t.ID==u.value,t))),A=async()=>{c.value=await v("/areas")},S=async()=>{p.value=await v("/crops")},q=async()=>{b.value=await v("/tasktypes")},N=t=>{n.value!=t&&(n.value=t,k.replace({query:{area:t}}))},$=t=>{s.value!=t&&(s.value=t)},x=t=>{u.value!=t&&(u.value=t)},L=async()=>{var e,r,w;const t={area_id:n.value,crop_id:s.value,type_id:u.value,name:(e=p.value.find(i=>i.ID==s.value))==null?void 0:e.name,description:((r=b.value.find(i=>i.ID==u.value))==null?void 0:r.name)+" "+((w=p.value.find(i=>i.ID==s.value))==null?void 0:w.name)};await v("/task/new",t),n.value,s.value,u.value=-1,k.push("/area/"+n)};return M(()=>{A(),S(),q()}),(t,e)=>{const r=R;return F(),P("div",G,[e[3]||(e[3]=l("h1",null,"Task Builder",-1)),a(g,{variant:"tonal",class:"mb-8",onClick:e[0]||(e[0]=w=>d(k).push("/area/"+d(n)))},{default:m(()=>e[1]||(e[1]=[I("Back to Area")])),_:1}),e[4]||(e[4]=l("br",null,null,-1)),a(f),e[5]||(e[5]=l("br",null,null,-1)),e[6]||(e[6]=l("h2",null,"Choose Area",-1)),a(C,null,{default:m(()=>[a(r,{items:d(B),newItem:t.$route.meta.userstatus=="admin"?"/area/builder":"",timeTracking:!1,onSelect:N},null,8,["items","newItem"])]),_:1}),e[7]||(e[7]=l("br",null,null,-1)),a(f),e[8]||(e[8]=l("br",null,null,-1)),e[9]||(e[9]=l("h2",null,"Choose Crop",-1)),a(C,null,{default:m(()=>[a(r,{search:"",items:d(D),newItem:t.$route.meta.userstatus=="admin"?"/cropbuilder":"",timeTracking:!1,onSelect:$},null,8,["items","newItem"])]),_:1}),e[10]||(e[10]=l("br",null,null,-1)),a(f),e[11]||(e[11]=l("br",null,null,-1)),e[12]||(e[12]=l("h2",null,"Task Type",-1)),a(C,null,{default:m(()=>[a(r,{items:d(V),newItem:"",timeTracking:!1,onSelect:x},null,8,["items"])]),_:1}),e[13]||(e[13]=l("br",null,null,-1)),a(f),e[14]||(e[14]=l("br",null,null,-1)),a(g,{size:"x-large",variant:"tonal",onClick:L},{default:m(()=>e[2]||(e[2]=[I(" Create Task ")])),_:1})])}}});export{W as default};
