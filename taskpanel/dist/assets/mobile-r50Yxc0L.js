import{_ as h}from"./CardSelector.vue_vue_type_script_setup_true_lang-DPfuUsuA.js";import{a as s}from"./apicall-BDFmDRg5.js";import{d as b,T as I,b as A,r,w as D,U as E,j as B,o as S,y as T,l as j,q}from"./index-BqBYkQoP.js";import"./VSwitch-CAezTYW2.js";import"./VMenu-Dna0TubK.js";import"./VTextField-DIRXKGr2.js";import"./VContainer-Bt1WHSop.js";const N=b({__name:"mobile",setup(C){I();const p=A(),n=r(!1),o=r(0),d=r(""),l=r(""),u=r(Array()),i=r(Array());r(Array());const _=r(0);D(()=>p.query.area,e=>{_.value=Number(e)});const m=async()=>{n.value=!0,k();const e=Array.from(await s("/hours/working")),c={},t={};u.value.forEach(a=>{c[a.ID]=0,t[a.area_id]=0}),e.forEach(a=>{c[a.task_id]++,t[a.task.area_id]++,a.worker.barcode==d.value&&(o.value=a.task_id)}),u.value.forEach(a=>{a.working=c[a.ID],a.selected=a.ID==o.value,a.selected&&i.value.forEach(v=>{v.selected=v.ID==a.area_id})}),i.value.forEach(a=>{a.working=t[a.ID]}),n.value=!1},k=async()=>{i.value=await s("/areas")},w=async()=>{n.value=!0,u.value=Array.from(await s("/tasks")),m(),n.value=!1},y=async()=>{const e=await s("/worker/lookup",{barcode:l.value});d.value=e.barcode},g=async e=>{o.value!=e&&(o.value=e,await s("/hours/punch",{anum:l,task:e}),m())};E(()=>{y(),w()});let f;return B(()=>{l.value=localStorage.getItem("anumber"),f=setInterval(m,6e4)}),S(()=>{clearInterval(f)}),(e,c)=>{const t=h;return j(),T(t,{search:"",stoptracking:"",items:e.taskList,onSelect:g,selected:q(o)},null,8,["items","selected"])}}});export{N as default};
