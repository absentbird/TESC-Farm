import{f as w,V as $,a as O,_ as q}from"./VSwitch-BPhlFusQ.js";import{d as z,r as n,b as H,e as x,h as L,o as M,i as h,j as V,c as s,x as W,l as r,t as d,k as l,F as D,y as G,v as J,H as P,q as S,s as U,E as Q,n as X}from"./index-B1rTmADD.js";import{V as _,a as k}from"./VRow-zDqRUmta.js";import{V as j}from"./VTextField-BEjPBO7F.js";import{a as Y}from"./VGrid-B2QB3Mq-.js";import{V as Z}from"./VContainer-CV5iNO1h.js";import{V as ee}from"./VSnackbar-CEExYas-.js";import"./VDivider-reVCDhED.js";import"./VMenu-Bojx4-GW.js";const ae={key:0,id:"anumfloat",class:"align-self-end"},de=z({__name:"index",setup(le){const g=n(!1),f=n(!1),m=n([]),c=n(""),p=n(""),u=n(0),A=n("mdi-form-textbox"),y=n(!1),E=n("success"),B=n(""),i=n({}),v=n({}),C=H("anum"),N=x(()=>{const a=new Set;for(const e of Array.from(i.value))for(const o of e.tags)a.add(o.name);return Array.from(a)}),F=x(()=>{let a=Array.from(i.value);return f.value?a.sort((e,o)=>e.name.localeCompare(o.name)):(a=a.filter(e=>w.includes(e.ID)),a.sort((e,o)=>w.indexOf(e.ID)-w.indexOf(o.ID))),m.value.length>0&&(a=a.filter(e=>e.tags.some(o=>m.value.includes(o.name)))),c.value&&(a=a.filter(e=>(e.name+e.description).toUpperCase().includes(c.value.toUpperCase()))),a}),K=x(()=>u.value==0?"None":u.value<0?"Stop Tracking Time":i.value.find(a=>a.ID===u.value).name),b=a=>{u.value=a,a!=0&&X(()=>{var e;(e=C.value)==null||e.focus()})},R=async()=>{g.value=!0;try{const a=await fetch("https://api.tesc.farm/tasks");a.ok||console.log(a.status),i.value=await a.json(),i.value.forEach(e=>{v.value[e.ID]=0})}catch(a){console.log(a)}finally{I()}},I=async()=>{g.value=!0;try{const a=await fetch("https://api.tesc.farm/hours/working");a.ok||console.log(a.status),i.value.forEach(o=>{v.value[o.ID]=0}),(await a.json()).forEach(o=>{v.value[o.task_id]++})}catch(a){console.log(a)}finally{g.value=!1}};let T;return L(()=>{R(),T=setInterval(I,6e4)}),M(()=>{clearInterval(T)}),(a,e)=>{const o=q;return V(),h(D,null,[s(Z,{fluid:"",id:"taskpanel",class:"fill-height d-flex flex-column withfloat"},{default:r(()=>[s(_,{id:"filters",class:"align-self-start d-flex w-100"},{default:r(()=>[s(k,{cols:"12",sm:"4",md:"8"},{default:r(()=>[s(j,{id:"search",modelValue:l(c),"onUpdate:modelValue":e[0]||(e[0]=t=>d(c)?c.value=t:null),clearable:"",label:"Search",hint:"Search for tasks by name or description"},null,8,["modelValue"])]),_:1}),s(k,{cols:"6",sm:"4",md:"2"},{default:r(()=>[s($,{clearable:"",chips:"",multiple:"",label:"Tags",modelValue:l(m),"onUpdate:modelValue":e[1]||(e[1]=t=>d(m)?m.value=t:null),items:l(N)},null,8,["modelValue","items"])]),_:1}),s(k,{cols:"6",sm:"4",md:"2",class:"d-flex align-self-start"},{default:r(()=>[s(O,{label:"Show All",inset:"",color:"secondary",modelValue:l(f),"onUpdate:modelValue":e[2]||(e[2]=t=>d(f)?f.value=t:null)},null,8,["modelValue"])]),_:1})]),_:1}),s(_,{id:"main-content",align:"center",justify:"center",class:"d-flex flex-row w-100"},{default:r(()=>[(V(!0),h(D,null,G(l(F),t=>(V(),J(o,{task:t,anumber:l(p),working:l(v)[t.ID],selected:l(u)==t.ID,onSelect:b},null,8,["task","anumber","working","selected"]))),256)),s(k,{cols:"12"},{default:r(()=>[s(Y,{class:P(["bigbutton",{selected:l(u)==-1}]),variant:"tonal",onClick:e[3]||(e[3]=t=>b(-1))},{default:r(()=>e[7]||(e[7]=[S(" Stop Tracking Time ")])),_:1},8,["class"])]),_:1})]),_:1})]),_:1}),l(u)?(V(),h("div",ae,[s(j,{id:"anum",ref_key:"anum",ref:C,"prepend-icon":l(A),modelValue:l(p),"onUpdate:modelValue":e[4]||(e[4]=t=>d(p)?p.value=t:null),onInput:a.anumCheck,onKeyup:U(a.submitAnum,["enter"]),onKeydown:e[5]||(e[5]=U(t=>b(0),["esc"])),hint:"Enter the A# from your student ID",label:l(K),autocomplete:"off"},null,8,["prepend-icon","modelValue","onInput","onKeyup","label"])])):W("",!0),s(ee,{modelValue:l(y),"onUpdate:modelValue":e[6]||(e[6]=t=>d(y)?y.value=t:null),timeout:"2000",location:"top",color:l(E)},{default:r(()=>[S(Q(l(B)),1)]),_:1},8,["modelValue","color"])],64)}}});export{de as default};
