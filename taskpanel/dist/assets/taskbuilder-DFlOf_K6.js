import{_ as L}from"./CardSelector.vue_vue_type_script_setup_true_lang-DKtBb_th.js";import{a as d}from"./apicall-ZcDvLpv2.js";import{d as R,T as $,b as E,r as o,i as b,j as F,k as j,l as z,E as l,c as a,t as p,q as k,v as M,F as G}from"./index-2V5DHb8u.js";import{o as v,l as T}from"./VMenu-CEOIS9lm.js";import{b as H}from"./VTextField-BqCknyMw.js";import"./VSwitch-CefifBqE.js";import"./VContainer-hUYed4Bj.js";const Y=R({__name:"taskbuilder",setup(J){const w=$(),y=E(),C=o([]),m=o([]),f=o([]),s=o(0),n=o(0),u=o(0);y.query.area&&(s.value=Number(y.query.area));const g=b(()=>C.value.map(t=>(t.selected=t.ID==s.value,t))),I=b(()=>m.value.map(t=>(t.selected=t.ID==n.value,t))),D=b(()=>f.value.map(t=>(t.selected=t.ID==u.value,t))),V=async()=>{C.value=await d("/areas")},B=async()=>{m.value=await d("/crops")},q=async()=>{f.value=await d("/tasktypes")},A=t=>{s.value!=t&&(s.value=t,w.push({query:{area:t}}))},N=t=>{n.value!=t&&(n.value=t)},S=t=>{u.value!=t&&(u.value=t)},x=async()=>{var e,r,c;const t={area_id:s.value,crop_id:n.value,type_id:u.value,name:(e=m.value.find(i=>i.ID==n.value))==null?void 0:e.name,description:((r=f.value.find(i=>i.ID==u.value))==null?void 0:r.name)+" "+((c=m.value.find(i=>i.ID==n.value))==null?void 0:c.name)};await d("/task/new",t),s.value,n.value,u.value=-1,w.back()};return F(()=>{V(),B(),q()}),(t,e)=>{const r=L;return z(),j(G,null,[e[1]||(e[1]=l("h1",null,"Task Builder",-1)),e[2]||(e[2]=l("br",null,null,-1)),a(v),e[3]||(e[3]=l("br",null,null,-1)),e[4]||(e[4]=l("h2",null,"Choose Area",-1)),a(T,null,{default:p(()=>[a(r,{items:k(g),newItem:t.$route.meta.userstatus=="admin"?"/areabuilder":"",timeTracking:!1,onSelect:A},null,8,["items","newItem"])]),_:1}),e[5]||(e[5]=l("br",null,null,-1)),a(v),e[6]||(e[6]=l("br",null,null,-1)),e[7]||(e[7]=l("h2",null,"Choose Crop",-1)),a(T,null,{default:p(()=>[a(r,{search:"",items:k(I),newItem:t.$route.meta.userstatus=="admin"?"/cropbuilder":"",timeTracking:!1,onSelect:N},null,8,["items","newItem"])]),_:1}),e[8]||(e[8]=l("br",null,null,-1)),a(v),e[9]||(e[9]=l("br",null,null,-1)),e[10]||(e[10]=l("h2",null,"Task Type",-1)),a(T,null,{default:p(()=>[a(r,{items:k(D),newItem:"",timeTracking:!1,onSelect:S},null,8,["items"])]),_:1}),e[11]||(e[11]=l("br",null,null,-1)),a(v),e[12]||(e[12]=l("br",null,null,-1)),a(H,{size:"x-large",variant:"tonal",onClick:x},{default:p(()=>e[0]||(e[0]=[M(" Create Task ")])),_:1})],64)}}});export{Y as default};
