import{g as w,p as _,i as D,a as j,b as h,m as x,d as V,j as r,k as f,h as v,w as b,l as a,n as T,t as S,q as k}from"./index-cergbCP0.js";import{u as B,m as I,a as P}from"./tag-uSSalK-p.js";const R=_({fluid:{type:Boolean,default:!1},...x(),...P(),...I()},"VContainer"),L=w()({name:"VContainer",props:R(),setup(l,n){let{slots:u}=n;const{rtlClasses:d}=D(),{dimensionStyles:m}=B(l);return j(()=>h(l.tag,{class:["v-container",{"v-container--fluid":l.fluid},d.value,l.class],style:[m.value,l.style]},u)),{}}}),N={id:"content"},O={key:0},U=V({__name:"index",setup(l){const n=r(!1);r(""),r(""),r("");const u=r("");r({}),r({}),r({});const d=(o,e)=>{const i=Object.keys(o[0]).join(","),c=o.map(g=>Object.values(g).join(",")),s=`${i}
${c.join(`
`)}`,t=URL.createObjectURL(new Blob([s],{type:"text/csv"})),p=document.createElement("a");p.href=t,p.download=e,p.style.display="none",document.body.appendChild(p),p.click(),document.body.removeChild(p)},m=async o=>{o.preventDefault(),n.value=!0;const e=await fetch("https://api.tesc.farm/hours");e.ok||(u.value=e.statusText);const i=await e.json().then(c=>c.filter(t=>t.duration>.017).map(t=>({id:t.ID,date:new Date(t.start).toLocaleDateString(),start:new Date(t.start).toLocaleTimeString(),hours:t.duration,task:t.task.name,description:t.task.description,task_id:t.task_id,crop_id:t.task.planting_id?t.task.planting.crop.ID:"N/A",worker_id:t.worker_id,notes:t.notes})));d(i,"hours.csv"),n.value=!1},y=async o=>{o.preventDefault(),n.value=!0;const e=await fetch("https://api.tesc.farm/tasks");e.ok||(u.value=e.statusText);const i=await e.json().then(c=>c.map(s=>({id:s.ID,name:s.name,description:s.description})));d(i,"tasks.csv"),n.value=!1},C=async o=>{o.preventDefault(),n.value=!0;const e=await fetch("https://api.tesc.farm/crops");e.ok||(u.value=e.statusText);const i=await e.json().then(c=>c.map(s=>({id:s.ID,name:s.name,variety:s.variety})));d(i,"crops.csv"),n.value=!1};return(o,e)=>(v(),f("section",N,[h(L,{id:"reportGenerator"},{default:b(()=>[e[0]||(e[0]=a("h1",null,"Report Panel",-1)),e[1]||(e[1]=a("p",null,"Download reports in CSV format from live data",-1)),a("ul",{id:"csvreportlist"},[a("li",null,[a("a",{href:"hours.csv",onClick:m},"Hours.csv")]),a("li",null,[a("a",{href:"tasks.csv",onClick:y},"Tasks.csv")]),a("li",null,[a("a",{href:"crops.csv",onClick:C},"Crops.csv")])]),a("p",null,S(k(u)),1),k(n)?(v(),f("p",O,"Imagine a spinning circle")):T("",!0)]),_:1})]))}});export{U as default};
